import React, { useState, useRef, useEffect } from "react";
import DateSelector from "./DayPicker";

interface SearchSitterItemProp {
  title: string;
}

const SearchSitterItem: React.FC<SearchSitterItemProp> = ({ title }) => {
  const [openDatePopUp, setOpenDatePopUp] = useState(false);
  const [openDatePopUpMax, setOpenDatePopUpMax] = useState(false);
  const [dateInp, setDateInp] = useState("");
  const [dateInpMax, setDateInpMax] = useState("");
  const [search, setSearch] = useState("");
  const dateNow = new Date().toDateString();

  const dateRef = useRef<HTMLDivElement>(null);
  const dateRefMax = useRef<HTMLDivElement>(null);

  const selectDate = (date: string) => {
    setDateInp(date);
    setOpenDatePopUp(false);
  };

  const selectDateMax = (date: string) => {
    setDateInpMax(date);
    setOpenDatePopUpMax(false);
  };

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (
        dateRef.current &&
        !dateRef.current.contains(event.target as Node) &&
        dateRefMax.current &&
        !dateRefMax.current.contains(event.target as Node)
      ) {
        setOpenDatePopUp(false);
        setOpenDatePopUpMax(false);
      }
    };

    document.addEventListener("mousedown", handleClickOutside);
    return () => document.removeEventListener("mousedown", handleClickOutside);
  }, []);

  return (
    <div>
      <div className="input-group">
        <div className="input">
          <h3>Где искать?</h3>
          <div className="input-place">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M9.73997 15.876C9.7563 15.9732 9.75332 16.0726 9.73119 16.1687C9.70906 16.2647 9.66823 16.3554 9.61102 16.4357C9.55382 16.5159 9.48135 16.5841 9.39778 16.6363C9.31421 16.6885 9.22117 16.7238 9.12397 16.74C6.72451 17.1428 4.43822 18.0516 2.41698 19.406C2.25161 19.5166 2.04909 19.557 1.85396 19.5182C1.65883 19.4795 1.48707 19.3649 1.37648 19.1995C1.26588 19.0341 1.2255 18.8316 1.26423 18.6365C1.30296 18.4413 1.41761 18.2696 1.58298 18.159C3.78084 16.6863 6.26687 15.6981 8.87598 15.26C8.97316 15.2437 9.07261 15.2467 9.16863 15.2688C9.26466 15.2909 9.35539 15.3317 9.43563 15.389C9.51587 15.4462 9.58405 15.5186 9.63627 15.6022C9.68849 15.6858 9.72373 15.7788 9.73997 15.876ZM14.26 15.876C14.2762 15.7788 14.3115 15.6858 14.3637 15.6022C14.4159 15.5186 14.4841 15.4462 14.5643 15.389C14.6446 15.3317 14.7353 15.2909 14.8313 15.2688C14.9273 15.2467 15.0268 15.2437 15.124 15.26C17.7331 15.6981 20.2191 16.6863 22.417 18.159C22.5823 18.2696 22.697 18.4413 22.7357 18.6365C22.7744 18.8316 22.7341 19.0341 22.6235 19.1995C22.5129 19.3649 22.3411 19.4795 22.146 19.5182C21.9509 19.557 21.7483 19.5166 21.583 19.406C19.5617 18.0516 17.2754 17.1428 14.876 16.74C14.7788 16.7238 14.6857 16.6885 14.6022 16.6363C14.5186 16.5841 14.4461 16.5159 14.3889 16.4357C14.3317 16.3554 14.2909 16.2647 14.2688 16.1687C14.2466 16.0726 14.2436 15.9732 14.26 15.876Z"
                fill="black"
              />
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M6.25 10C6.25 8.47501 6.8558 7.01247 7.93414 5.93414C9.01247 4.8558 10.475 4.25 12 4.25C13.525 4.25 14.9875 4.8558 16.0659 5.93414C17.1442 7.01247 17.75 8.47501 17.75 10C17.75 12.742 16.386 15.153 15.095 16.832C14.3812 17.7557 13.582 18.6101 12.708 19.384C12.6356 19.4467 12.5622 19.5084 12.488 19.569L12.475 19.581L12.471 19.584H12.469C12.469 19.585 12.469 19.586 12 19L11.57 19.614L11.567 19.612L11.563 19.609L11.548 19.599L11.499 19.563L11.324 19.431C11.1183 19.2698 10.9176 19.1023 10.722 18.929C10.0665 18.3489 9.46163 17.7139 8.914 17.031C7.604 15.394 6.25 12.983 6.25 10ZM12 19L11.57 19.614C11.7027 19.7071 11.8621 19.7548 12.0242 19.7497C12.1862 19.7447 12.3423 19.6872 12.469 19.586L12 19ZM11.974 18.027C12.0607 17.9483 12.156 17.8583 12.26 17.757C12.8525 17.1844 13.4027 16.5694 13.906 15.917C15.114 14.347 16.25 12.258 16.25 10C16.25 8.87283 15.8022 7.79183 15.0052 6.9948C14.2082 6.19777 13.1272 5.75 12 5.75C10.8728 5.75 9.79183 6.19777 8.9948 6.9948C8.19777 7.79183 7.75 8.87283 7.75 10C7.75 12.517 8.895 14.606 10.086 16.094C10.6515 16.7977 11.2838 17.445 11.974 18.027ZM12 8.75C11.6685 8.75 11.3505 8.8817 11.1161 9.11612C10.8817 9.35054 10.75 9.66848 10.75 10C10.75 10.3315 10.8817 10.6495 11.1161 10.8839C11.3505 11.1183 11.6685 11.25 12 11.25C12.3315 11.25 12.6495 11.1183 12.8839 10.8839C13.1183 10.6495 13.25 10.3315 13.25 10C13.25 9.66848 13.1183 9.35054 12.8839 9.11612C12.6495 8.8817 12.3315 8.75 12 8.75ZM9.25 10C9.25 9.27065 9.53973 8.57118 10.0555 8.05546C10.5712 7.53973 11.2707 7.25 12 7.25C12.7293 7.25 13.4288 7.53973 13.9445 8.05546C14.4603 8.57118 14.75 9.27065 14.75 10C14.75 10.7293 14.4603 11.4288 13.9445 11.9445C13.4288 12.4603 12.7293 12.75 12 12.75C11.2707 12.75 10.5712 12.4603 10.0555 11.9445C9.53973 11.4288 9.25 10.7293 9.25 10Z"
                fill="black"
              />
            </svg>
            <input
              type="text"
              placeholder="Where to look?"
              value={search}
              onChange={(e) => setSearch(e.target.value)}
            />
          </div>
        </div>

        <div className="input inptDate">
          <h3>{title}</h3>

          <div>
            <div ref={dateRef} className="input inputs-date">
              <div
                className="input-place"
                onClick={() => {
                  setOpenDatePopUp(!openDatePopUp);
                  setOpenDatePopUpMax(false);
                }}
              >
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.5 14C8.83152 14 9.14946 13.8683 9.38388 13.6339C9.6183 13.3995 9.75 13.0815 9.75 12.75C9.75 12.4185 9.6183 12.1005 9.38388 11.8661C9.14946 11.6317 8.83152 11.5 8.5 11.5C8.16848 11.5 7.85054 11.6317 7.61612 11.8661C7.3817 12.1005 7.25 12.4185 7.25 12.75C7.25 13.0815 7.3817 13.3995 7.61612 13.6339C7.85054 13.8683 8.16848 14 8.5 14ZM8.5 17.5C8.83152 17.5 9.14946 17.3683 9.38388 17.1339C9.6183 16.8995 9.75 16.5815 9.75 16.25C9.75 15.9185 9.6183 15.6005 9.38388 15.3661C9.14946 15.1317 8.83152 15 8.5 15C8.16848 15 7.85054 15.1317 7.61612 15.3661C7.3817 15.6005 7.25 15.9185 7.25 16.25C7.25 16.5815 7.3817 16.8995 7.61612 17.1339C7.85054 17.3683 8.16848 17.5 8.5 17.5ZM13.25 12.75C13.25 13.0815 13.1183 13.3995 12.8839 13.6339C12.6495 13.8683 12.3315 14 12 14C11.6685 14 11.3505 13.8683 11.1161 13.6339C10.8817 13.3995 10.75 13.0815 10.75 12.75C10.75 12.4185 10.8817 12.1005 11.1161 11.8661C11.3505 11.6317 11.6685 11.5 12 11.5C12.3315 11.5 12.6495 11.6317 12.8839 11.8661C13.1183 12.1005 13.25 12.4185 13.25 12.75ZM12 17.5C12.3315 17.5 12.6495 17.3683 12.8839 17.1339C13.1183 16.8995 13.25 16.5815 13.25 16.25C13.25 15.9185 13.1183 15.6005 12.8839 15.3661C12.6495 15.1317 12.3315 15 12 15C11.6685 15 11.3505 15.1317 11.1161 15.3661C10.8817 15.6005 10.75 15.9185 10.75 16.25C10.75 16.5815 10.8817 16.8995 11.1161 17.1339C11.3505 17.3683 11.6685 17.5 12 17.5ZM16.75 12.75C16.75 13.0815 16.6183 13.3995 16.3839 13.6339C16.1495 13.8683 15.8315 14 15.5 14C15.1685 14 14.8505 13.8683 14.6161 13.6339C14.3817 13.3995 14.25 13.0815 14.25 12.75C14.25 12.4185 14.3817 12.1005 14.6161 11.8661C14.8505 11.6317 15.1685 11.5 15.5 11.5C15.8315 11.5 16.1495 11.6317 16.3839 11.8661C16.6183 12.1005 16.75 12.4185 16.75 12.75Z"
                    fill="black"
                  />
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M8 3.25C8.19891 3.25 8.38968 3.32902 8.53033 3.46967C8.67098 3.61032 8.75 3.80109 8.75 4V4.75H15.25V4C15.25 3.80109 15.329 3.61032 15.4697 3.46967C15.6103 3.32902 15.8011 3.25 16 3.25C16.1989 3.25 16.3897 3.32902 16.5303 3.46967C16.671 3.61032 16.75 3.80109 16.75 4V4.758C16.902 4.762 17.0437 4.76933 17.175 4.78C17.555 4.81 17.911 4.878 18.248 5.05C18.7656 5.31367 19.1863 5.73445 19.45 6.252C19.622 6.589 19.69 6.945 19.72 7.325C19.75 7.69 19.75 8.135 19.75 8.67V16.33C19.75 16.865 19.75 17.31 19.72 17.675C19.69 18.055 19.622 18.411 19.45 18.748C19.1866 19.2654 18.7662 19.6862 18.249 19.95C17.911 20.122 17.555 20.19 17.175 20.22C16.81 20.25 16.365 20.25 15.831 20.25H8.17C7.635 20.25 7.19 20.25 6.825 20.22C6.445 20.19 6.089 20.122 5.752 19.95C5.23475 19.6869 4.81401 19.2668 4.55 18.75C4.378 18.412 4.31 18.056 4.28 17.676C4.25 17.311 4.25 16.866 4.25 16.332V8.67C4.25 8.135 4.25 7.69 4.28 7.325C4.31 6.945 4.378 6.589 4.55 6.252C4.81367 5.73445 5.23445 5.31367 5.752 5.05C6.089 4.878 6.445 4.81 6.825 4.78C6.95633 4.76933 7.098 4.762 7.25 4.758V4C7.25 3.90151 7.2694 3.80398 7.30709 3.71299C7.34478 3.62199 7.40003 3.53931 7.46967 3.46967C7.53931 3.40003 7.62199 3.34478 7.71299 3.30709C7.80398 3.2694 7.90151 3.25 8 3.25ZM7.25 6.5V6.258C7.14887 6.26111 7.04784 6.26678 6.947 6.275C6.66 6.298 6.523 6.34 6.433 6.386C6.19741 6.50591 6.00591 6.69741 5.886 6.933C5.84 7.023 5.798 7.16 5.775 7.447C5.751 7.743 5.75 8.127 5.75 8.7V9.25H18.25V8.7C18.25 8.128 18.25 7.743 18.225 7.447C18.202 7.16 18.16 7.023 18.114 6.933C17.9941 6.69741 17.8026 6.50591 17.567 6.386C17.477 6.34 17.34 6.298 17.052 6.275C16.9515 6.2668 16.8508 6.26113 16.75 6.258V6.5C16.75 6.69891 16.671 6.88968 16.5303 7.03033C16.3897 7.17098 16.1989 7.25 16 7.25C15.8011 7.25 15.6103 7.17098 15.4697 7.03033C15.329 6.88968 15.25 6.69891 15.25 6.5V6.25H8.75V6.5C8.75 6.69891 8.67098 6.88968 8.53033 7.03033C8.38968 7.17098 8.19891 7.25 8 7.25C7.80109 7.25 7.61032 7.17098 7.46967 7.03033C7.32902 6.88968 7.25 6.69891 7.25 6.5ZM18.25 10.25H5.75V16.3C5.75 16.872 5.75 17.257 5.775 17.552C5.798 17.84 5.84 17.977 5.886 18.067C6.006 18.303 6.197 18.494 6.433 18.614C6.523 18.66 6.66 18.702 6.947 18.725C7.243 18.749 7.627 18.75 8.2 18.75H15.8C16.372 18.75 16.757 18.75 17.052 18.725C17.34 18.702 17.477 18.66 17.567 18.614C17.8026 18.4941 17.9941 18.3026 18.114 18.067C18.16 17.977 18.202 17.84 18.225 17.552C18.249 17.257 18.25 16.872 18.25 16.3V10.25Z"
                    fill="black"
                  />
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M9.75 7.75C9.75 7.55109 9.82902 7.36032 9.96967 7.21967C10.1103 7.07902 10.3011 7 10.5 7H13.5C13.6989 7 13.8897 7.07902 14.0303 7.21967C14.171 7.36032 14.25 7.55109 14.25 7.75C14.25 7.94891 14.171 8.13968 14.0303 8.28033C13.8897 8.42098 13.6989 8.5 13.5 8.5H10.5C10.3011 8.5 10.1103 8.42098 9.96967 8.28033C9.82902 8.13968 9.75 7.94891 9.75 7.75Z"
                    fill="black"
                  />
                </svg>

                <input
                  type="text"
                  placeholder={dateNow}
                  value={dateInp}
                  readOnly
                />
              </div>
              <div
                className={`dayPicker picker1 ${openDatePopUp ? "hide" : ""}`}
              >
                <DateSelector selectDate={selectDate} />
              </div>
            </div>

            <div ref={dateRefMax} className="input">
              <div
                className="input-place"
                onClick={() => {
                  setOpenDatePopUpMax(!openDatePopUpMax);
                  setOpenDatePopUp(false);
                }}
              >
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.5 14C8.83152 14 9.14946 13.8683 9.38388 13.6339C9.6183 13.3995 9.75 13.0815 9.75 12.75C9.75 12.4185 9.6183 12.1005 9.38388 11.8661C9.14946 11.6317 8.83152 11.5 8.5 11.5C8.16848 11.5 7.85054 11.6317 7.61612 11.8661C7.3817 12.1005 7.25 12.4185 7.25 12.75C7.25 13.0815 7.3817 13.3995 7.61612 13.6339C7.85054 13.8683 8.16848 14 8.5 14ZM8.5 17.5C8.83152 17.5 9.14946 17.3683 9.38388 17.1339C9.6183 16.8995 9.75 16.5815 9.75 16.25C9.75 15.9185 9.6183 15.6005 9.38388 15.3661C9.14946 15.1317 8.83152 15 8.5 15C8.16848 15 7.85054 15.1317 7.61612 15.3661C7.3817 15.6005 7.25 15.9185 7.25 16.25C7.25 16.5815 7.3817 16.8995 7.61612 17.1339C7.85054 17.3683 8.16848 17.5 8.5 17.5ZM13.25 12.75C13.25 13.0815 13.1183 13.3995 12.8839 13.6339C12.6495 13.8683 12.3315 14 12 14C11.6685 14 11.3505 13.8683 11.1161 13.6339C10.8817 13.3995 10.75 13.0815 10.75 12.75C10.75 12.4185 10.8817 12.1005 11.1161 11.8661C11.3505 11.6317 11.6685 11.5 12 11.5C12.3315 11.5 12.6495 11.6317 12.8839 11.8661C13.1183 12.1005 13.25 12.4185 13.25 12.75ZM12 17.5C12.3315 17.5 12.6495 17.3683 12.8839 17.1339C13.1183 16.8995 13.25 16.5815 13.25 16.25C13.25 15.9185 13.1183 15.6005 12.8839 15.3661C12.6495 15.1317 12.3315 15 12 15C11.6685 15 11.3505 15.1317 11.1161 15.3661C10.8817 15.6005 10.75 15.9185 10.75 16.25C10.75 16.5815 10.8817 16.8995 11.1161 17.1339C11.3505 17.3683 11.6685 17.5 12 17.5ZM16.75 12.75C16.75 13.0815 16.6183 13.3995 16.3839 13.6339C16.1495 13.8683 15.8315 14 15.5 14C15.1685 14 14.8505 13.8683 14.6161 13.6339C14.3817 13.3995 14.25 13.0815 14.25 12.75C14.25 12.4185 14.3817 12.1005 14.6161 11.8661C14.8505 11.6317 15.1685 11.5 15.5 11.5C15.8315 11.5 16.1495 11.6317 16.3839 11.8661C16.6183 12.1005 16.75 12.4185 16.75 12.75Z"
                    fill="black"
                  />
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M8 3.25C8.19891 3.25 8.38968 3.32902 8.53033 3.46967C8.67098 3.61032 8.75 3.80109 8.75 4V4.75H15.25V4C15.25 3.80109 15.329 3.61032 15.4697 3.46967C15.6103 3.32902 15.8011 3.25 16 3.25C16.1989 3.25 16.3897 3.32902 16.5303 3.46967C16.671 3.61032 16.75 3.80109 16.75 4V4.758C16.902 4.762 17.0437 4.76933 17.175 4.78C17.555 4.81 17.911 4.878 18.248 5.05C18.7656 5.31367 19.1863 5.73445 19.45 6.252C19.622 6.589 19.69 6.945 19.72 7.325C19.75 7.69 19.75 8.135 19.75 8.67V16.33C19.75 16.865 19.75 17.31 19.72 17.675C19.69 18.055 19.622 18.411 19.45 18.748C19.1866 19.2654 18.7662 19.6862 18.249 19.95C17.911 20.122 17.555 20.19 17.175 20.22C16.81 20.25 16.365 20.25 15.831 20.25H8.17C7.635 20.25 7.19 20.25 6.825 20.22C6.445 20.19 6.089 20.122 5.752 19.95C5.23475 19.6869 4.81401 19.2668 4.55 18.75C4.378 18.412 4.31 18.056 4.28 17.676C4.25 17.311 4.25 16.866 4.25 16.332V8.67C4.25 8.135 4.25 7.69 4.28 7.325C4.31 6.945 4.378 6.589 4.55 6.252C4.81367 5.73445 5.23445 5.31367 5.752 5.05C6.089 4.878 6.445 4.81 6.825 4.78C6.95633 4.76933 7.098 4.762 7.25 4.758V4C7.25 3.90151 7.2694 3.80398 7.30709 3.71299C7.34478 3.62199 7.40003 3.53931 7.46967 3.46967C7.53931 3.40003 7.62199 3.34478 7.71299 3.30709C7.80398 3.2694 7.90151 3.25 8 3.25ZM7.25 6.5V6.258C7.14887 6.26111 7.04784 6.26678 6.947 6.275C6.66 6.298 6.523 6.34 6.433 6.386C6.19741 6.50591 6.00591 6.69741 5.886 6.933C5.84 7.023 5.798 7.16 5.775 7.447C5.751 7.743 5.75 8.127 5.75 8.7V9.25H18.25V8.7C18.25 8.128 18.25 7.743 18.225 7.447C18.202 7.16 18.16 7.023 18.114 6.933C17.9941 6.69741 17.8026 6.50591 17.567 6.386C17.477 6.34 17.34 6.298 17.052 6.275C16.9515 6.2668 16.8508 6.26113 16.75 6.258V6.5C16.75 6.69891 16.671 6.88968 16.5303 7.03033C16.3897 7.17098 16.1989 7.25 16 7.25C15.8011 7.25 15.6103 7.17098 15.4697 7.03033C15.329 6.88968 15.25 6.69891 15.25 6.5V6.25H8.75V6.5C8.75 6.69891 8.67098 6.88968 8.53033 7.03033C8.38968 7.17098 8.19891 7.25 8 7.25C7.80109 7.25 7.61032 7.17098 7.46967 7.03033C7.32902 6.88968 7.25 6.69891 7.25 6.5ZM18.25 10.25H5.75V16.3C5.75 16.872 5.75 17.257 5.775 17.552C5.798 17.84 5.84 17.977 5.886 18.067C6.006 18.303 6.197 18.494 6.433 18.614C6.523 18.66 6.66 18.702 6.947 18.725C7.243 18.749 7.627 18.75 8.2 18.75H15.8C16.372 18.75 16.757 18.75 17.052 18.725C17.34 18.702 17.477 18.66 17.567 18.614C17.8026 18.4941 17.9941 18.3026 18.114 18.067C18.16 17.977 18.202 17.84 18.225 17.552C18.249 17.257 18.25 16.872 18.25 16.3V10.25Z"
                    fill="black"
                  />
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M9.75 7.75C9.75 7.55109 9.82902 7.36032 9.96967 7.21967C10.1103 7.07902 10.3011 7 10.5 7H13.5C13.6989 7 13.8897 7.07902 14.0303 7.21967C14.171 7.36032 14.25 7.55109 14.25 7.75C14.25 7.94891 14.171 8.13968 14.0303 8.28033C13.8897 8.42098 13.6989 8.5 13.5 8.5H10.5C10.3011 8.5 10.1103 8.42098 9.96967 8.28033C9.82902 8.13968 9.75 7.94891 9.75 7.75Z"
                    fill="black"
                  />
                </svg>

                <input
                  type="text"
                  placeholder="Выберите дату"
                  value={dateInpMax}
                  readOnly
                />
              </div>
              <div
                className={`dayPicker picker2 ${
                  openDatePopUpMax ? "hide" : ""
                }`}
              >
                <DateSelector selectDate={selectDateMax} />
              </div>
            </div>
          </div>
        </div>

        <div
          className={`input btn ${
            search || dateInp || dateInpMax ? "hide" : ""
          }`}
        >
          <button>
            <span>Искать</span>
            <svg
              width="18"
              height="18"
              viewBox="0 0 23 23"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10.0625 18.2084C14.5614 18.2084 18.2083 14.5614 18.2083 10.0625C18.2083 5.56362 14.5614 1.91669 10.0625 1.91669C5.56356 1.91669 1.91663 5.56362 1.91663 10.0625C1.91663 14.5614 5.56356 18.2084 10.0625 18.2084Z"
                stroke="white"
                strokeWidth="2"
                strokeLinejoin="round"
              />
              <path
                d="M12.7731 6.87269C12.4174 6.51631 11.9949 6.23368 11.5297 6.04102C11.0646 5.84836 10.5659 5.74946 10.0625 5.75C9.55897 5.74946 9.06033 5.84836 8.59517 6.04102C8.13 6.23368 7.70746 6.51631 7.35181 6.87269M15.9188 15.9189L19.9846 19.9846"
                stroke="white"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  );
};

export default SearchSitterItem;
